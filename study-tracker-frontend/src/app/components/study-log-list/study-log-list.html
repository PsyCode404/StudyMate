<div class="space-y-6">
  
  <!-- Loading State -->
  <div *ngIf="loading" class="flex flex-col items-center justify-center py-20">
    <div class="animate-spin rounded-full h-12 w-12 border-4 border-primary-200 border-t-primary-600"></div>
    <p class="mt-4 text-neutral-600 font-medium">Loading study logs...</p>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && studyLogs.length === 0" class="bg-white rounded-2xl shadow-card border border-neutral-200 p-12 text-center">
    <div class="flex justify-center mb-4">
      <div class="w-16 h-16 rounded-full bg-primary-100 flex items-center justify-center">
        <mat-icon class="!w-8 !h-8 !text-4xl text-primary-600">library_books</mat-icon>
      </div>
    </div>
    <h2 class="text-2xl font-bold text-neutral-900 mb-2">No Study Logs Yet</h2>
    <p class="text-neutral-600">Start tracking your study sessions by adding your first log!</p>
  </div>

  <!-- Data View -->
  <div *ngIf="!loading && studyLogs.length > 0" class="space-y-6">
    
    <!-- Search and Filter Bar -->
    <div class="bg-white rounded-xl shadow-card border border-neutral-200 p-5">
      <div class="flex items-center gap-3 mb-4">
        <div class="w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center">
          <mat-icon class="!w-5 !h-5 !text-xl text-primary-600">filter_list</mat-icon>
        </div>
        <div>
          <h3 class="text-lg font-bold text-neutral-900">Search & Filter</h3>
          <p class="text-sm text-neutral-600">Find specific study logs</p>
        </div>
      </div>

      <div class="space-y-4">
        <!-- Search Bar -->
        <div class="relative">
          <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
            <mat-icon class="!w-5 !h-5 !text-xl text-neutral-400">search</mat-icon>
          </div>
          <input 
            type="text"
            [(ngModel)]="searchQuery"
            (ngModelChange)="onSearchChange()"
            placeholder="Search by subject, topic, or notes..."
            class="w-full pl-12 pr-4 py-3 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors text-neutral-900 placeholder-neutral-500">
        </div>

        <!-- Date Range Filters -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <!-- Start Date -->
          <div>
            <label class="block text-sm font-medium text-neutral-700 mb-2">
              <span class="flex items-center gap-2">
                <mat-icon class="!w-4 !h-4 !text-base text-primary-600">event</mat-icon>
                Start Date
              </span>
            </label>
            <mat-form-field appearance="outline" class="w-full">
              <input 
                matInput 
                [matDatepicker]="startPicker" 
                [(ngModel)]="startDate"
                (ngModelChange)="onStartDateChange()"
                [max]="endDate || maxDate"
                placeholder="Select start date">
              <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
              <mat-datepicker #startPicker></mat-datepicker>
            </mat-form-field>
          </div>

          <!-- End Date -->
          <div>
            <label class="block text-sm font-medium text-neutral-700 mb-2">
              <span class="flex items-center gap-2">
                <mat-icon class="!w-4 !h-4 !text-base text-primary-600">event</mat-icon>
                End Date
              </span>
            </label>
            <mat-form-field appearance="outline" class="w-full">
              <input 
                matInput 
                [matDatepicker]="endPicker" 
                [(ngModel)]="endDate"
                (ngModelChange)="onEndDateChange()"
                [min]="startDate"
                [max]="maxDate"
                placeholder="Select end date">
              <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
              <mat-datepicker #endPicker></mat-datepicker>
            </mat-form-field>
          </div>
        </div>

        <!-- Filter Actions -->
        <div class="flex items-center justify-between pt-2 border-t border-neutral-200">
          <div class="flex items-center gap-2">
            <span class="text-sm text-neutral-600">
              Showing <span class="font-semibold text-neutral-900">{{ getFilteredCount() }}</span> of <span class="font-semibold text-neutral-900">{{ studyLogs.length }}</span> logs
            </span>
            <span *ngIf="hasActiveFilters()" class="inline-flex items-center gap-1 px-2 py-1 bg-primary-100 text-primary-700 rounded-lg text-xs font-semibold">
              <mat-icon class="!w-3 !h-3 !text-xs">filter_alt</mat-icon>
              Filtered
            </span>
          </div>
          <button 
            *ngIf="hasActiveFilters()"
            (click)="clearFilters()"
            class="flex items-center gap-2 px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded-lg font-medium hover:bg-neutral-50 transition-colors">
            <mat-icon class="!w-4 !h-4 !text-base">clear</mat-icon>
            <span>Clear Filters</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Summary Stats -->
    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
      <div class="bg-white rounded-xl shadow-card border border-neutral-200 p-5">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center">
            <mat-icon class="!w-5 !h-5 !text-xl text-primary-600">library_books</mat-icon>
          </div>
          <div>
            <p class="text-2xl font-bold text-neutral-900">{{ studyLogs.length }}</p>
            <p class="text-sm text-neutral-600">{{ studyLogs.length === 1 ? 'Log' : 'Logs' }}</p>
          </div>
        </div>
      </div>
      
      <div class="bg-white rounded-xl shadow-card border border-neutral-200 p-5">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 rounded-lg bg-accent-100 flex items-center justify-center">
            <mat-icon class="!w-5 !h-5 !text-xl text-accent-600">school</mat-icon>
          </div>
          <div>
            <p class="text-2xl font-bold text-neutral-900">{{ getSubjectsCount() }}</p>
            <p class="text-sm text-neutral-600">{{ getSubjectsCount() === 1 ? 'Subject' : 'Subjects' }}</p>
          </div>
        </div>
      </div>
      
      <div class="bg-white rounded-xl shadow-card border border-neutral-200 p-5">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center">
            <mat-icon class="!w-5 !h-5 !text-xl text-primary-600">schedule</mat-icon>
          </div>
          <div>
            <p class="text-2xl font-bold text-neutral-900">{{ formatDuration(getTotalDuration()) }}</p>
            <p class="text-sm text-neutral-600">Total Time</p>
          </div>
        </div>
      </div>
    </div>

    <!-- No Results State (when filtered) -->
    <div *ngIf="filteredLogs.length === 0" class="bg-white rounded-2xl shadow-card border border-neutral-200 p-12 text-center">
      <div class="flex justify-center mb-4">
        <div class="w-16 h-16 rounded-full bg-neutral-100 flex items-center justify-center">
          <mat-icon class="!w-8 !h-8 !text-4xl text-neutral-400">search_off</mat-icon>
        </div>
      </div>
      <h2 class="text-2xl font-bold text-neutral-900 mb-2">No Results Found</h2>
      <p class="text-neutral-600 mb-4">Try adjusting your search or filter criteria</p>
      <button 
        (click)="clearFilters()"
        class="inline-flex items-center gap-2 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg font-medium shadow-sm transition-colors">
        <mat-icon class="!w-5 !h-5 !text-xl">clear</mat-icon>
        <span>Clear Filters</span>
      </button>
    </div>

    <!-- Study Logs Cards -->
    <div *ngIf="filteredLogs.length > 0" class="grid grid-cols-1 gap-4">
      <div *ngFor="let log of filteredLogs" 
           class="bg-white rounded-xl shadow-card border border-neutral-200 p-5 hover:shadow-hover transition-shadow">
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
          <!-- Log Info -->
          <div class="flex-1 space-y-3">
            <!-- Subject & Topic -->
            <div>
              <div class="flex items-center gap-2 mb-1">
                <span class="inline-flex items-center gap-1.5 px-3 py-1 bg-gradient-to-r from-primary-100 to-accent-100 text-primary-700 rounded-lg text-sm font-semibold">
                  <mat-icon class="!w-4 !h-4 !text-base">school</mat-icon>
                  {{ log.subject }}
                </span>
                <span *ngIf="log.notes" 
                      [matTooltip]="log.notes"
                      class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-neutral-100 text-neutral-600 cursor-help">
                  <mat-icon class="!w-4 !h-4 !text-sm">notes</mat-icon>
                </span>
              </div>
              <h3 class="text-lg font-semibold text-neutral-900">{{ log.topic }}</h3>
            </div>

            <!-- Meta Info -->
            <div class="flex flex-wrap items-center gap-4 text-sm text-neutral-600">
              <span class="flex items-center gap-1.5">
                <mat-icon class="!w-4 !h-4 !text-base text-primary-600">schedule</mat-icon>
                <span class="font-medium">{{ formatDuration(log.duration) }}</span>
              </span>
              <span class="flex items-center gap-1.5">
                <mat-icon class="!w-4 !h-4 !text-base text-primary-600">calendar_today</mat-icon>
                <span>{{ formatDate(log.date) }}</span>
              </span>
            </div>
          </div>

          <!-- Actions -->
          <div class="flex items-center gap-2 sm:flex-col sm:gap-2">
            <button 
              (click)="onView(log)"
              matTooltip="View Details"
              class="flex items-center justify-center w-9 h-9 rounded-lg bg-primary-50 text-primary-600 hover:bg-primary-100 transition-colors">
              <mat-icon class="!w-5 !h-5 !text-xl">visibility</mat-icon>
            </button>
            <button 
              (click)="onEdit(log)"
              matTooltip="Edit"
              class="flex items-center justify-center w-9 h-9 rounded-lg bg-accent-50 text-accent-600 hover:bg-accent-100 transition-colors">
              <mat-icon class="!w-5 !h-5 !text-xl">edit</mat-icon>
            </button>
            <button 
              (click)="onDelete(log)"
              matTooltip="Delete"
              class="flex items-center justify-center w-9 h-9 rounded-lg bg-red-50 text-red-600 hover:bg-red-100 transition-colors">
              <mat-icon class="!w-5 !h-5 !text-xl">delete</mat-icon>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
